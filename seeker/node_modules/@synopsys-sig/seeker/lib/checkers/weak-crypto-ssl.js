"use strict";function e(i,r){function c(e){new s(r).withContext({cipher:e}).submit()}e.super_.apply(this,arguments),this.cipherSuitesMap=new Map,this.initCipherSuites=function e(i){i.forEach(e=>{this.cipherSuitesMap.set(e.name.toUpperCase(),e.properties)})},this.checkCiphers=function e(i){i||(i=t.DEFAULT_CIPHERS);const r=this;let s="";i.split(":").forEach(function(e){if(-1!==e.indexOf("-")){let i=r.cipherSuitesMap.get(e.toUpperCase());i?(i.keySize>0&&i.keySize<128||"RC4"===i.algorithm||"RC2"===i.algorithm||"DES_CBC"===i.algorithm)&&(0!==s.length&&(s+=", "),s+=e):n.warn("Cipher suite not found: '"+e+"'")}}),0!==s.length&&c(s)},this.start=function e(){const t=this,s=require("../resources/checkers/weak-crypto-ssl/ciphersuites.json");t.initCipherSuites(s),i.services.tls.on(r,"createSecureContext",function(e){e&&t.checkCiphers(e.ciphers)})}}const i=require("util"),t=require("tls"),r=require("./_AbstractChecker"),s=require("../services/finding-service").FindingBuilder,n=require("../util/logger");i.inherits(e,r),module.exports=function(i,t){return new e(i,t)};