"use strict";function t(e,r){function a(t,e){let r,i="";const s=new n.Parser({onopentag:function(t,n){if(!r){i=t,t===e&&(r={type:c.TAG_NAME});for(const t of Object.keys(n)){const s=n[t];t===e?r=""===s?{type:c.TAG_ATT_VALUE_NOQUOTE,tag:i,att:t}:{type:c.TAG_ATT_NAME,tag:i,att:t}:s===e&&(r={type:c.TAG_ATT_VALUE,tag:i,att:t})}}},ontext:function(t){r||t===e&&(r={type:c.TAG_CONTENT,tag:i,att:""})}});return s.write(t),s.end(),r}t.super_.apply(this,arguments),this.start=function t(){e.services.http.on(r,"responseWrite",function(t){const n=t.value;if(e.services.datatainting.isTaintedAndNotSanitized(n,"HTML")){const t=n instanceof Buffer?s.bufferToStringExcerpt(n):n;new i(r).withTaintedDefaults(n).withContext({response:t}).submit()}})},this.isReplayable=function t(){return!0},this.getTamperedValue=function t(){return"skr87563"},this.getTamperedStatus=function t(e){const n=e.newFinding.getSinkValue(),r=e.newFinding.getSourceValue(),i=n&&n.includes(r);return i&&(e.context=a(n,r)),i},this.getVerificationValues=function t(e){const n=e.initialFinding.getSourceValue();if(e.context.type===c.TAG_CONTENT)return"script"===e.context.tag?[n+'";skr23555()',n+"';skr23555()",n+";skr23555()"]:"textarea"===e.context.tag.toLowerCase()?["</textarea><script src=skr23555/>"]:["<script src=skr23555/>"];if(e.context.type===c.TAG_ATT_VALUE){const t=['" onmouseover=skr23555',"' onmouseover=skr23555"];return"frame"===e.context.tag.toLowerCase()&&"src"===e.context.att.toLowerCase()&&t.push("; skr23555()"),e.context.att.startsWith("on")&&t.push("; skr23555()"),t}return e.context.type===c.TAG_ATT_VALUE_NOQUOTE?u.includes(e.context.tag.toLowerCase())?[n+"src=skr23555"]:[" onmouseover=skr23555"]:e.context.type===c.TAG_ATT_NAME||e.context.type===c.TAG_NAME?[" onmouseover=skr23555"]:[n+'"/><script>skr23555<\/script>']},this.getStatusForReplay=function t(e){const n=e.newFinding.getSinkValue(),r=e.newFinding.getSourceValue();return n&&n.includes(r)?o.VERIFIED:o.ELIMINATED}}const e=require("util"),n=require("htmlparser2"),r=require("./_AbstractChecker"),i=require("../services/finding-service").FindingBuilder,s=require("../util/misc"),o=require("../entities/enums/replay-status"),c=require("../entities/enums/html-context-location"),u=["audio","embed","iframe","img","input","script","source","track","video"];e.inherits(t,r),module.exports=function(e,n){return new t(e,n)};