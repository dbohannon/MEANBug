"use strict";function e(t,r){function o(e,r){let n=new Map,i;t.services.htmlparser.parse(e,{onopentag:function(e,t){if("form"===e)i=t,t.id&&(n[t.id]=t);else if("input"===e){let e=t.autocomplete||"",s="new-password"!==e;if(!s)return;let a=u(t,i,n);if(a&&""===e){let e=a.autocomplete||"";s="new-password"!==e}if(s)for(let e=0;e<r.length;++e)t.name&&t.name.match(new RegExp(r[e].parameterNamePattern,"i"))&&c(a,t,r[e]),t.id&&t.id.match(new RegExp(r[e].parameterNamePattern,"i"))&&c(a,t,r[e])}}})}function u(e,t,r){return void 0!==e.form?r[e.form]:t}function c(e,t,i){new n(r).withDefaults().withContext({name:i.name,formAttributes:e?JSON.stringify(e,null,0):"",inputAttributes:JSON.stringify(t,null,0)}).submit()}function f(e){let r=[];const n=t.config.processCfg.projectEnvCfg.sensitiveParameterMatchers;if(!n)return r;for(let t=0;t<n.length;++t){const i=n[t];".*"!==i.parameterValuePattern||!e.match(i.originalUrlStringRegexRule)||i.type!==a.HTTP_PARAM&&"ALL"!==i.type||r.push(i)}return s.removeDuplicatesAndEmptyValues(r)}e.super_.apply(this,arguments);const p=new Set;this.start=function e(){t.services.http.on(r,"requestEnded",function(e){let t=f(e.requestData.path);if(0!==t.length)try{if(!e.responseData.body||!e.responseData.headers)return;{const t=e.getResponseHeader("content-type");if(!t||!t.includes("html"))return;if("GET"!==e.requestData.method)return}const r=e.requestData.method+"_"+e.requestData.url;if(p.has(r))return;p.add(r);let n=e.responseData.body instanceof Buffer?String.fromCharCode.apply(null,e.responseData.body):e.responseData.body;o(n,t)}catch(e){i.trace("Checker %s failed to parse the HTML: ",this.id,e)}})},this._reset=function(){p.clear()}}const t=require("util"),r=require("./_AbstractChecker"),n=require("../services/finding-service").FindingBuilder,i=require("../util/logger"),s=require("../util/misc"),a=require("../entities/enums/source-type");t.inherits(e,r),module.exports=function(t,r){return new e(t,r)};