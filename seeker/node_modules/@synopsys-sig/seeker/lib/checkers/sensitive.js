"use strict";function e(t,i){function c(e,n,r){if(r=r||!1){if(!t.services.datatainting.isTaintedRecursively(n))return}else if(!t.services.datatainting.isTaintedAndNotSanitized(n,i))return;const s=t.config.processCfg.projectEnvCfg.sensitiveParameterMatchers;if(s){const i=t.services.http.getCurrentRequestData();if(i)for(let t=0;t<s.length;++t){const c=s[t];c.type===a.HTTP_PARAM?o(i.path,c,i.params,e,n,a.HTTP_PARAM,r):c.type===a.HTTP_HEADER?o(i.path,c,i.headers,e,n,a.HTTP_HEADER,r):(o(i.path,c,i.params,e,n,a.HTTP_PARAM,r),o(i.path,c,i.headers,e,n,a.HTTP_HEADER,r))}}}function o(e,a,c,o,f,d,h){s.checkMatchers(e,a,c,e=>{let s;let m;h?(s=t.services.datatainting.isTaintedRecursively(f))&&s.taintedObjectsMap.get(e)&&(m=c[e],f=n.get(o,s.taintedObjectsMap.get(e).path),o=s.query):(s=t.services.datatainting.getTaintInfo(f),m=c[s.sourceName]);u(m,f)&&new r(i).withTaintedDefaults(h?s.taintedObject:f).withContext({name:a.name,origin:o,input:e,type:d}).submit()})}function u(e,t){if(!e)return!1;t=t.toLowerCase();for(let n=0;n<e.length;n++)if(-1!==t.toLowerCase().indexOf(e[n].toLowerCase()))return!0;return!1}e.super_.apply(this,arguments),this.start=function e(){t.services.nosql.on(i,"command",function(e){e.command&&e.command.query&&c(e.command.query,e.command.query,!0)}),t.services.sql.on(i,"query",function(e){c(e.statement,e.statement)}),t.services.fs.on(i,"write",function(e){c(e.filepath,e.value)}),t.services.log.on(i,"log",function(e){e instanceof Array?e.forEach(e=>c(e,e)):c(e,e)})}}const t=require("util"),n=require("lodash"),i=require("./_AbstractChecker"),r=require("../services/finding-service").FindingBuilder,s=require("../util/sensitive-matcher"),a=require("../entities/enums/source-type");t.inherits(e,i),module.exports=function(t,n){return new e(t,n)};