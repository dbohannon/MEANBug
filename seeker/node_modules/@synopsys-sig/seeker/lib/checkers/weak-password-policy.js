"use strict";function e(t,r){function o(e){t.services.htmlparser.parse(e,{onopentag:function(e,t){if("input"===e){if(!t.type||"password"!==t.type)return;t.name&&l.add(t.name),t.id&&l.add(t.id)}}})}function u(){new n(r).withDefaults().withContext({maskedPassword:i.sensitiveDataMask}).submit()}function c(e,t,r){const n=e.getResponseHeader(t);return n&&n.includes(r)}function d(e,t,r){const n=e.getRequestHeader(t);return n&&n.includes(r)}function f(e){e.requestData.params&&Object.keys(e.requestData.params).forEach(t=>{let r=e.requestData.params[t];l.has(t)&&r&&!i.isStrongPassword(r.toString())&&u()}),e.requestData.body&&d(e,"content-type","application/x-www-form-urlencoded")&&Object.keys(e.requestData.body).forEach(t=>{let r=e.requestData.body[t];l.has(t)&&r&&!i.isStrongPassword(r.toString())&&u()})}function p(e){try{if(!e.responseData.body||!c(e,"content-type","html"))return;const t=e.requestData.method+"_"+e.requestData.url;if(h.has(t))return;h.add(t);let r=e.responseData.body instanceof Buffer?a.bufferToString(e.responseData.body):e.responseData.body;o(r)}catch(e){s.trace("Checker WEAK-PASSWORD-POLICY failed to parse the HTML: ",e)}}e.super_.apply(this,arguments);const h=new Set,l=new Set;this.start=function e(){t.services.http.on(r,"requestEnded",function(e){p(e),f(e)})}}const t=require("util"),r=require("./_AbstractChecker"),n=require("../services/finding-service").FindingBuilder,s=require("../util/logger"),a=require("../util/misc"),i=require("../util/crypto-utils");t.inherits(e,r),module.exports=function(t,r){return new e(t,r)};