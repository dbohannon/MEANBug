"use strict";const e=require("path"),t=require("fs"),n=require("os").EOL,o=function(){function o(e){let t;return(t="global"!==e.moduleId?require.resolve(e.moduleId):e.moduleId)+" "+e.wrapperName+" "+e.type+" "+e.methodName}function i(){t.appendFileSync(r.filePath,r.logStream),r.logStream=""}this.init=function(o){let a=0;t.readdirSync(o).forEach(e=>{const t=e.match(new RegExp("agent_inst_(\\d*).log"));t&&t[1]>a&&(a=parseInt(t[1]))}),r.filePath=e.join(o,"agent_inst_"+(a+1)+".log"),r.logStream="",setInterval(i,500),process.on("uncaughtException",function(e){throw r.logStream+=e.toString()+n,r.logStream+=e.stack+n,i(),e})},this.log=function(e,t){if(r.filePath){const i=o(t);r.logStream+=e+" "+i+n}}},r=new o;module.exports=r;