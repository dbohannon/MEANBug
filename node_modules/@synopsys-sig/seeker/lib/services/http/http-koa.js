"use strict";function e(){this.handleInstrumentation=function(e){e.services.instrumentation.register({moduleId:"koa/lib/application",methodNames:"createContext",type:"prototype",callbacks:{__sk_doAfter:function(e,t){return process.domain&&process.domain.__sk_local?process.domain.__sk_local.koaContext=t:i.warn("Undefined process.domain.__sk_local"),t}}}),e.services.instrumentation.register({moduleId:"cookies/index",methodNames:"get",type:"prototype",callbacks:{__sk_doAfter:function(t,i,o){const r=o[0],c=i;return e.services.datatainting.taintSource(null,r,{sourceValue:r,sourceName:r,sourceType:s.HTTP_COOKIE,flowStateData:new n(a.SOURCE,c,void 0,e.services.datatainting.includeStacktrace())}),e.services.datatainting.taintSource(null,c,{sourceValue:c,sourceName:r,sourceType:s.HTTP_COOKIE,flowStateData:new n(a.SOURCE,c,void 0,e.services.datatainting.includeStacktrace())}),i}}})}}const t=require("util"),i=require("../../util/logger"),n=require("../../entities/flow-state-data"),a=require("../../entities/enums/flowstate-data-type"),s=require("../../entities/enums/source-type");t.inherits(e,require("events").EventEmitter),module.exports=new e;