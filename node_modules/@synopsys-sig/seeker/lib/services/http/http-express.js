"use strict";function e(){this.handleInstrumentation=function(e){const t=e.services.instrumentation,s=e.services.http;t.register({moduleId:"express/lib/router/index",methodNames:["use","route"],callbacks:{__sk_doAfter:function(t,s,r){return"string"==typeof r[0]&&r[0].includes(":")&&t.stack&&t.stack.length>0&&(e.services.http.pathsMap[t.stack[t.stack.length-1].regexp.toString()]=r[0]),s}}}),t.register({moduleId:"express/lib/router/layer",methodNames:"handle_request",type:"prototype",callbacks:{__sk_doBefore:function(t,r){if(process.domain)r[2]=r[2]&&process.domain.bind(r[2]);else if(s.skipRequestIfNeeded(r[0]))return;const i=r[0],n=e.services.http.pathsMap[t.regexp.toString()];if(n){let t=n;i&&i.originalUrl&&i._parsedUrl&&i._parsedUrl.path&&(t=i.baseUrl.substring(0,i.originalUrl.indexOf(i._parsedUrl.path))+n),e.services.http.setCurrentRestTemplate(t)}e.services.http.emit("requestBodyInitialized",i)}}})}}const t=require("util");t.inherits(e,require("events").EventEmitter),module.exports=new e;