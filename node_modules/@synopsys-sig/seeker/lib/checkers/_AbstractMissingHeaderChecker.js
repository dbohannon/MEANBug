"use strict";function e(t,r){e.super_.apply(this,arguments),this.missingHeaderKey="Must be overridden!",this.start=function e(){const o=this;t.services.http.on(r,"requestEnded",function(e){if(!o.isEliminatedByOtherHeader(e)&&("HEAD"!==e.requestData.method&&"TRACE"!==e.requestData.method||!e.requestData.headers[n.REPLAY_ACTIVE_HEADER])){const t=e.getResponseHeader("Content-Type");t&&!o.acceptContentType(t)||o.isOnlyForSsl()&&"https"!==e.requestData.protocol||void 0===e.getResponseHeader(o.missingHeaderKey)&&new s(r).withCurrentRequest().withContext({responseHeaders:i.formatHeadersForContext(e.responseData.headers)}).submit()}})},this.isEliminatedByOtherHeader=function(){return!1},this.isOnlyForSsl=function(){return!1},this.acceptContentType=function(){return!0}}const t=require("util"),r=require("./_AbstractChecker"),s=require("../services/finding-service").FindingBuilder,i=require("../util/http-utils"),n=require("../entities/enums/replay-header");t.inherits(e,r),module.exports=e;