"use strict";function t(e,n){function r(t){return t&&(t.indexOf(s)>=0||t.indexOf("127.0.0.1")>=0)}function i(t){new o(n).withContext({url:t}).withDefaults().submit()}let s;this.getContextFields=function t(){return["url"]},this.start=function t(){s=e.config.bootstrapCfg.collectorHost+":"+e.config.bootstrapCfg.collectorPort,e.services.http.on(n,"requestSent",function(t,e){if("https"!==e&&"request"!==e){let e;"string"==typeof t||t instanceof String?e=t:(e=(t._defaultAgent?t._defaultAgent.protocol:t.protocol||"http:")+"//",e+=t.hostname||t.host||"localhost",t.port&&null!==t.port&&"80"!==t.port.toString()&&(e=e+":"+t.port)),e.startsWith("http://")&&!r(e)&&i(e+=t.path||"/")}})},t.super_.apply(this,arguments)}const e=require("util"),n=require("./_AbstractChecker"),o=require("../services/finding-service").FindingBuilder;e.inherits(t,n),module.exports=function(e,n){return new t(e,n)};