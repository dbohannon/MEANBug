"use strict";function e(n,t){function s(e,n){for(let t=e.indexOf(n)-1;t>=0;t--){const n=e.charAt(t);if("'"===n)return u.FILTER;if("="===n)return u.FILTER_NO_QUOTE}return u.UNKNOWN}e.super_.apply(this,arguments),this.start=function e(){n.services.sql.on(t,"query",function(e){const r=e.statement;n.services.datatainting.isTaintedAndNotSanitized(r,"SQL")&&new i(t).withTaintedDefaults(r).withContext({query:r}).submit()})},this.isReplayable=function e(){return!0},this.getTamperedValue=function e(){return"87563"},this.getTamperedStatus=function e(n){const t=n.newFinding.getSinkValue(),i=n.newFinding.getSourceValue();return t&&t.includes(i)},this.getVerificationValues=function e(n){const t=n.initialFinding.getSourceValue(),i=s(n.newFinding.checkerContext.query,n.newFinding.getSourceValue());return i&&i===u.FILTER_NO_QUOTE?["skr93014"]:[t.substr(0,t.length-1)+"'"]},this.getStatusForReplay=function e(n){const t=n.newFinding.getSinkValue(),i=n.newFinding.getSourceValue(),u=n.errors,s=u&&u.find(e=>{const t=n.newFinding.requestDatas.find(n=>e.uuid===n.uuid);return t&&e.error.message.includes("ER_PARSE_ERROR")||e.error.stack.includes("Connection.parse")});return s&&s.error&&t&&t.includes(i)?(n.initialFinding.replayData.error=s.error.toString(),r.VERIFIED):r.ELIMINATED}}const n=require("util"),t=require("./_AbstractChecker"),i=require("../services/finding-service").FindingBuilder,r=require("../entities/enums/replay-status"),u=require("../entities/enums/sql-context-location");n.inherits(e,t),module.exports=function(n,t){return new e(n,t)};