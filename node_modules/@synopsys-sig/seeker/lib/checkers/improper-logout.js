"use strict";function s(e,t){function n(s){"init"===i.get(s)&&i.set(s,"logout")}s.super_.apply(this,arguments);const i=new Map;e.services.httpsession.on(t,"sessionInit",function(s){i.set(s.type,"init")}),e.services.httpsession.on(t,"sessionLogout",function(s){n(s),"passport"===s&&n("koa-passport")}),e.services.http.on(t,"requestEnded",function(s){if(!(s.responseData.statusCode>=400&&s.responseData.statusCode<600)&&i.size&&(process.domain&&process.domain.__sk_local&&process.domain.__sk_local.koaContext&&!process.domain.__sk_local.koaContext.request.ctx.session&&i.set("koa-session","logout"),s.requestData.path.includes("logout"))){let s=!1;i.forEach((e,t)=>{"logout"===e&&(s=!0,i.set(t,"init"))}),s||new o(t).withDefaults().submit()}})}const e=require("./_AbstractChecker"),t=require("util"),o=require("../services/finding-service").FindingBuilder;t.inherits(s,e),module.exports=function(e,t){return new s(e,t)};