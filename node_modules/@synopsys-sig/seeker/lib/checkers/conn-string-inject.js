"use strict";function t(e,n){function o(t){return t.toLowerCase()!==t.toUpperCase()}function a(t){let e="",n=0,i="";for(;n<t.length;)i=t.charAt(n),isNaN(1*i)?o(i)?i===i.toUpperCase()?e+=c[Math.floor(26*Math.random())]:i===i.toLowerCase()&&(e+=l[Math.floor(26*Math.random())]):e+=i:e+=f[Math.floor(10*Math.random())],n++;return e}function u(t,r){t&&e.services.datatainting.isTainted(t)&&new i(n).withTaintedDefaults(t).withContext({connectionStringUrl:"object"==typeof r?JSON.stringify(r,null,0):r+""}).submit()}t.super_.apply(this,arguments);const c=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],l=["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],f=["0","1","2","3","4","5","6","7","8","9"];this.start=function t(){e.services.sql.on(n,"dbconnect",function(t){const e=t.config;if("string"==typeof e||e instanceof String)u(e,e);else{let t=JSON.parse(JSON.stringify(e));t.password&&(t.password=s),u(e.host,t),u(e.port,t),u(e.localAddress,t),u(e.socketPath,t),u(e.database,t)}})},this.isReplayable=function t(){return!0},this.getVerificationValue=function t(e){return a(e.initialFinding.getSourceValue())},this.getStatusForReplay=function t(e){const n=e.newFinding.getSinkValue(),i=e.newFinding.getSourceValue();return n&&n.indexOf(i)>-1?r.VERIFIED:r.ELIMINATED}}const e=require("util"),n=require("./_AbstractChecker"),i=require("../services/finding-service").FindingBuilder,r=require("../entities/enums/replay-status"),s=require("../util/crypto-utils").sensitiveDataMask;e.inherits(t,n),module.exports=function(e,n){return new t(e,n)};