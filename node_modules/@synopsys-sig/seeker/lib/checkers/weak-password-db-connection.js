"use strict";function t(n,i){function o(t,n){r.isStrongPassword(t)||new e(i).withDefaults().withContext({maskedPassword:r.sensitiveDataMask,connectionString:n}).submit()}this.getContextFields=function t(){return["connectionString"]},this.start=function t(){n.services.sql.on(i,"dbconnect",function(t){const n=t.config,i="pg"===t.type?"postgres":t.type;if("string"==typeof n||n instanceof String){const t=s.parsePasswordFromConnectionString(n);o(t,n)}else n.password&&o(n.password,s.connectionStringFromConfig(n,i))})},t.super_.apply(this,arguments)}const n=require("util"),i=require("./_AbstractChecker"),e=require("../services/finding-service").FindingBuilder,s=require("../util/misc"),r=require("../util/crypto-utils");n.inherits(t,i),module.exports=function(n,i){return new t(n,i)};