"use strict";function e(t,i){e.super_.apply(this,arguments),this.start=function e(){t.services.http.on(i,"requestEnded",function(e){let t=e.getResponseHeader("X-Frame-Options");if(void 0===t)t="N/A";else{const i=t.toLowerCase();if("deny"===i||"sameorigin"===i)return;if(0===i.indexOf("allow-from")){const i=t.split(" ");if(i.length>1){let t=r.parse(i[1]);if(t&&t.protocol+"//"+t.hostname==e.requestData.protocol+"://"+e.reqHostname)return}}}new s(i).withContext({xFrameOptionsValue:t,clickjackingUrl:e.requestData.url,clickjackingHeaders:n.formatHeadersForContext(e.responseData.headers)}).withDefaults().submit()})}}const t=require("util"),r=require("url"),i=require("./_AbstractChecker"),s=require("../services/finding-service").FindingBuilder,n=require("../util/http-utils");t.inherits(e,i),module.exports=function(t,r){return new e(t,r)};