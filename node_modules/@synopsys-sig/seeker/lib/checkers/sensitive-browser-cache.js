"use strict";function e(t,r){function s(e){let r=new Map,n;t.services.htmlparser.parse(e,{onopentag:function(e,t){if("form"===e)n=t,void 0!==t.id&&(r[t.id]=t);else if("input"===e){if(!t.type||"password"!==t.type)return;let e=t.autocomplete||"",i="new-password"!==e;if(!i)return;let s=o(t,n,r);if(void 0!==s&&""===e){let e=s.autocomplete||"";i="new-password"!==e}i&&u(s,t)}}})}function o(e,t,r){return void 0!==e.form?r[e.form]:t}function u(e,t){new n(r).withDefaults().withContext({formAttributes:void 0!==e?JSON.stringify(e,null,0):"",inputAttributes:JSON.stringify(t,null,0)}).submit()}e.super_.apply(this,arguments);const a=new Set;this.start=function e(){t.services.http.on(r,"requestEnded",function(e){try{if(!e.responseData.body||!e.responseData.headers)return;{const t=e.getResponseHeader("content-type");if(!t||!t.includes("html"))return;const r=e.requestData.method+"_"+e.requestData.url;if(a.has(r))return;a.add(r)}let t=e.responseData.body instanceof Buffer?String.fromCharCode.apply(null,e.responseData.body):e.responseData.body;s(t)}catch(e){i.trace("Checker %s failed to parse the HTML: ",this.id,e)}})}}const t=require("util"),r=require("./_AbstractChecker"),n=require("../services/finding-service").FindingBuilder,i=require("../util/logger");t.inherits(e,r),module.exports=function(t,r){return new e(t,r)};